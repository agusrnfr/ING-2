<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <%- include ('header', {tituloweb: '¡Oh my dog! | Registrar Trabajador'}); %>
</head>

<body id="body">
  <div class="container h-100 mt-4">
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col-lg-12 col-xl-8">
        <div class="card text-black" style="border-radius: 25px;">
          <div class="card-body p-md-5 p-lg-5">
            <div class="row justify-content-center">
              <p class="text-center h1 fw-bold mb-5 mx-1 mx-md-4 ">Registrar Trabajador</p>

              <div class="col-md-10 col-lg-5 col-xl-6 order-2 order-lg-1">

                <form id="myForm" action="/registrar_trabajador" method="POST">
                  <div class="row mb-3">
                    

                    <label for="monto">Nombre y Apellido (*)</label>
                    <div class="mb-3">
                      <input class="form-control form-control-user" name="nombre" type="text" id="nombre"
                        placeholder="Ingrese nombre y apellido del trabajador" required=" ">
                    </div>

                    <label for="monto">Email (*)</label>
                    <div class="mb-3">
                      <input class="form-control form-control-user" name="email" type= "email" id="email"
                        placeholder="Ingrese el email del trabajador" required=" ">
                        <small id="emailError" style="color: black;"></small>
                    </div>

                    <label for="servicio">Tipo de servicio (*)</label>
                    <div class="mb-3">
                      <select class="form-control form-control-user" name="servicio" id="servicio">
                        <option value="" disabled selected>Selecciona un servicio</option>
                        <option value="Paseador|Cuidador">Paseador|Cuidador</option>
                        <option value="Guarderia">Guardería</option>
                      </select>
                    </div>

                    <label for="zona">Zona (*)</label>
                    <div class="mb-3">
                      <select class="form-control form-control-user" name="zona" id="zona" required>
                        <option value="" disabled selected>Selecciona una zona</option>
                        <option value="Plaza Moreno">Plaza Moreno</option>
                        <option value="Plaza San Martín">Plaza San Martín</option>
                        <option value="Plaza Belgrano">Plaza Belgrano</option>
                        <option value="Plaza Azcuénaga">Plaza Azcuénaga</option>
                        <option value="Plaza Islas Malvinas">Plaza Islas Malvinas</option>
                        <option value="Plaza Italia">Plaza Italia</option>
                        <option value="Plaza Rocha">Plaza Rocha</option>
                        <option value="Plaza Paso">Plaza Paso</option>
                        <option value="Plaza Sarmiento">Plaza Sarmiento</option>
                        <option value="Plaza Almirante Brown">Plaza Almirante Brown</option>
                        <option value="Plaza España">Plaza España</option>
                        <option value="Plaza Güemes">Plaza Güemes</option>
                        <option value="Plaza Mateu">Plaza Mateu</option>
                        <option value="Plaza Grigera">Plaza Grigera</option>
                        <option value="Plaza Malvinas Argentinas">Plaza Malvinas Argentinas</option>
                        <option value="Plaza Güemes Este">Plaza Güemes Este</option>
                      </select>
                    </div>

                    <label for="servicio">Dias disponibles (*)</label>
                    <div class="mb-3">
                      <input type="checkbox" name="dia" id="domingo" value="Domingo">
                      <label for="domingo">Domingo</label>
                      <br>
                      <input type="checkbox" name="dia" id="lunes" value="Lunes">
                      <label for="lunes">Lunes</label>
                      <br>
                      <input type="checkbox" name="dia" id="martes" value="Martes">
                      <label for="martes">Martes</label>
                      <br>
                      <input type="checkbox" name="dia" id="miercoles" value="Miercoles">
                      <label for="miercoles">Miercoles</label>
                      <br>
                      <input type="checkbox" name="dia" id="jueves" value="Jueves">
                      <label for="jueves">Jueves</label>
                      <br>
                      <input type="checkbox" name="dia" id="viernes" value="Viernes">
                      <label for="viernes">Viernes</label>
                      <br>
                      <input type="checkbox" name="dia" id="sabado" value="Sabado">
                      <label for="sabado">Sabado</label>
                      <br>
                    </div>

                    <label for="monto">Rango de Horario Disponible (*)</label>
                    <div class="mb-3">
                      <input class="form-control form-control-user" type="text" name="horaInicio" id="horaInicio" placeholder="Ejemplo: 08:00" required>
                      <small id="horaErrorInicio" style="color: black;"></small>
                      <br>
                      
                      <input class="form-control form-control-user" type="text" name="horaFin" id="horaFin" placeholder="Ejemplo: 18:00" required>
                      <small id="horaErrorFin" style="color: black;"></small>
                    </div>

                    <div class="text-center mb-2" style="font-size: smaller;">Los campos con (*) son obligatorios</div>

                    <div id="mensaje"></div>
                    
                  </div>

                  <button id="registrar" class="btn btn-primary d-block btn-user w-100" name="registrar" type="submit">Registrar</button>
                </form>
              </div>

              <div class="col-md-10 col-lg-6 col-xl-6 d-flex align-items-start order-1 order-lg-2 justify-content-center">
                <img src="/img/trabajador1.jpg" width="380px">
              </div>

            </div>

            <style>
              @media only screen and (max-width: 900px) {
                img {
                  display: none;
                }

                div {
                  display: block;
                }
              }
            </style>
          </div>
          <hr>
          <div class="text-center"><a class="small" href="/">Volver</a></div>
        </div>
      </div>
    </div>
  </div>
  <br>

    <!-- Modal de confirmación de envio-->
    <div class="modal fade" id="modalConfirmacion" tabindex="-1" aria-labelledby="modalConfirmacionLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header" style="text-align: center;">
              <h5 class="modal-title  text-center" id="modalConfirmacionLabel">Confirmacion de registro</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" style="text-align: center;">
                    <p>¿Desea registrar esta trabajador?</p>
                </div>
                  <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                  <button type="button" class="btn btn-primary" id="btnConfirmar" onclick="confirmarUtilizacion()">Confirmar</button>
             </div>
          </div>
        </div>
    </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
  crossorigin="anonymous"></script>
<script src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.1/themes/smoothness/jquery-ui.css">
  
<script>
  var inputHoraInicio = document.getElementById("horaInicio");
  var inputHoraFin = document.getElementById("horaFin");

  inputHoraInicio.addEventListener("input", function() {
    this.value = this.value.replace(/[^0-9:]/g, "");
    this.value = this.value.replace(/(\d{2})(\d{1,2})/, "$1:$2");
    this.value = this.value.replace(/(:\d{3}).*$/, "$1");
    this.value = this.value.slice(0, 5);
  });

  inputHoraFin.addEventListener("input", function() {
    this.value = this.value.replace(/[^0-9:]/g, "");
    this.value = this.value.replace(/(\d{2})(\d{1,2})/, "$1:$2");
    this.value = this.value.replace(/(:\d{3}).*$/, "$1");
    this.value = this.value.slice(0, 5);
  });

</script>

<script>
const btnEnviar = document.getElementById("registrar");

function camposVacios() {
  const nombreInput = document.getElementById('nombre');
  const emailInput = document.getElementById('email');
  const zonaInput = document.getElementById('zona');
  const servicioInput = document.getElementById('servicio');
  const horaInicioInput = document.getElementById('horaInicio');
  const horaFinInput = document.getElementById('horaFin');

  const nombre = nombreInput.value;
  const email = emailInput.value;
  const zona = zonaInput.value;
  const servicio = servicioInput.value;
  const horaInicio = horaInicioInput.value;
  const horaFin = horaFinInput.value;

   // Obtener los checkboxes de los días
   const diasInputs = document.querySelectorAll('input[name="dia"]:checked');
   const dias = Array.from(diasInputs).map((input) => input.value).join(',');

  if (!nombre || !email.trim() || !servicio || !zona || !horaInicio || !horaFin || dias.length === 0) {
    const mensajeElemento = document.getElementById('mensaje');
    mensajeElemento.textContent = 'Por favor complete todos los campos solicitados y seleccione al menos un día.';
     return true;
  }
  return false;
}

function emailValidacion(){
  const emailInput = document.getElementById('email');
  const email = emailInput.value;  
  const emailError = document.getElementById('emailError');
    if (!emailInput.validity.valid || !email.includes("@")) {
      emailError.textContent = "Ingrese una dirección de correo electrónico válida";
      return true;
    } 
  return false;  
}

function horaValidacionInicio() {
  var inputHoraInicio = document.getElementById("horaInicio");
  const horaErrorInicio = document.getElementById('horaErrorInicio');

  if (inputHoraInicio.value.length < 5 ) {
      horaErrorInicio.textContent = "El formato de hora es ej: 08:00";
      return true;
    }
  return false;
}

function horaValidacionFin() {
  var inputHoraFin = document.getElementById("horaFin");
  const horaError = document.getElementById('horaErrorFin');

  if (inputHoraFin.value.length < 5 ) {
      horaError.textContent = "El formato de hora es ej: 18:00";
      return true;
    }
  return false;
}

function confirmarUtilizacion() {
  // Cerrar el modal
  $('#modalConfirmacion').modal('hide');

  // Enviar el formulario
  document.getElementById('myForm').submit();
}

function confirmarRegistro() {
  $('#modalConfirmacion').modal('show');
}

btnEnviar.onclick = function(event) {
  event.preventDefault();
  if (camposVacios() || emailValidacion() || horaValidacionInicio() || horaValidacionFin()) {
    return false;
  } else {
    confirmarRegistro();
  }
};
</script>

<%- include ('sweet-alert') %>
</body>

</html>